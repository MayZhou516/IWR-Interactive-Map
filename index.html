<html>
<!-- TODOS:
	1.Figure out why ticker text is staying black
	2. Get this on a heroku
	3. Adjust column styling
	4. Get little human svg and make a legend 
	5. Style circle onhovers
	6. Slider drag latency?

 -->
<head>
	<script src="https://d3js.org/d3.v3.min.js"></script>
 	<!-- using v3 rather than v4 because datamaps wont operate without it -->
	<script src="http://d3js.org/topojson.v2.min.js"></script>
	<script src="datamaps.world.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
	<script src="d3.slider.js"></script>
	<link rel="stylesheet" href="style.css" type="text/css">
	<link rel="stylesheet" href="d3.slider.css" type="text/css">
	<link rel="stylesheet" href="foundation.min.css" type="text/css">
</head>
<body>
	<h1 class="header"> Ithaca Through Refugees </h1>
	<div class="row">
		<div id="bubbles" class="small-12 large-6 columns">
			<div id= "ordinalScale"></div>
		</div>
		<div class="description small-12 large-6 columns">
			<h1 class="caption"> 1990 Bosnia conflict </h1>
			<p class="details">Taking it slow, but it's not typicalHe already knows that my love is fire His heart was a stone, but then his hands roamed I turned him to gold and it took him higher Well, I'll be your daydream, I'll be your favorite things We could be beautiful Get drunk on the good life, I'll take you to paradise Say you'll never let me go Deep in my bones, I can feel you Take me back to a time only we knew Hideaway We could waste the night with an old film Smoke a little weed on the couch in the back room Hideaway Say you'll never let me go Say you'll never let me go Ah, ah, ah Ah, ah, ah Ah, ah, ah Say you'll never let me go Say you'll never let me go Say you'll never let me go Say you'll never let me go Deep in my bones, I can feel you Take me back to a time only we knew Hideaway We could waste the night with an old film Smoke a little weed on the couch in the back room Hideaway Say you'll never let me go Say you'll never let me go
			<br> <br>sfljdshjl </p> 

		</div>
	</div>
	
	

 	<script>
var map = new Datamap({
  element: document.getElementById("bubbles"),
  done: function(datamap) {
            datamap.svg.selectAll('.datamaps-subunit').on('click', function(geography) {
            
            	// clears arcs, bubbles on each click of a country, could be useful
            	$('#bubbles g.arc').empty();
            	$('#bubbles g.bubbles').empty();

            	//enables click a country, draw arc from that point to Ithaca
        		console.log("Entering arc drawing");
        		map.arc([
        		{
        			strokeColor: '#6AE368',
        			origin: geography.id,
        			destination: {
        				// this is Ithaca
        				latitude: '42.4440',
        				longitude: '-76.5019'
        			}	
        		}
    			], {strokeWidth: 1, arcSharpness: 1.4});
      
            	console.log(geography);
            });
        },

  geographyConfig: {
    popupOnHover: false,
    highlightOnHover: true,
    highlightFillColor: '#6AE368'
  },
  fills: {
  	// sets to black for default
    defaultFill: '#000000'
  }
});

// generates slider
// little bit of latency due to json load, how to fix????
events = d3.slider().scale(d3.scale.ordinal().domain(["NULL", "Syria", "Australia", "India", "Brazil"]).rangePoints([0, 1], 0.5)).axis(d3.svg.axis()).snap(true).value("NULL");

//handles slider movement
d3.select('#ordinalScale').call(events.on("slide", function (evt, value){
	//fill this in with actual data
	data={"Syria":
		{
			name: 'SYR',
			refugees: '10',
			caption:'Closer',
			details:'Hey, I was doing just fine before I met you I drink too much and thats an issue But Im OK Hey, you tell your friends it was nice to meet them But I hope I never see them Again I know it breaks your heart Moved to the city in a broke-down car And four years, no calls Now youre looking pretty in a hotel bar And I, I, I, I, I cant stop No, I, I, I, I, I cant stop So, baby, pull me closer In the back seat of your Rover That I know you cant afford Bite that tattoo on your shoulder Pull the sheets right off the corner Of that mattress that you stole From your roommate back in Boulder We aint ever getting older We aint ever getting older We aint ever getting older You look as good as the day I met you I forget just why I left you, I was insane Stay and play that Blink-182 song That we beat to death in Tucson, OK'
		},
		"Australia":
		{
			name: "AUS",
			refugees: "20",
			caption: "Dont let me down",
			details:'Crashing, hit a wall Right now I need a miracle Hurry up now, I need a miracle Stranded, reaching out I call your name but youre not around I say your name but youre not around I need ya, I need ya, I need you right now Yeah, I need you right now So dont let me, dont let me, dont let me down I think Im losing my mind now Its in my head, darling, I hope That youll be here, when I need you the most So dont let me, dont let me, dont let me down D-dont let me down Dont let me down Dont let me down, down, down Dont let me down, dont let me down, down, down'
		},
		"India":
		{
			name: "IND",
			refugees: "30",
			caption: "Paris",
			details:'We were staying in Paris To get away from your parents And I thought, "Wow, if I could take this in a shot right now I dont think that we could work this out."Out on the terrace I dont know if its fair but I thought, "How could I let you fall by yourself While Im wasted with someone else?"If we go down then we go down together Theyll say you could do anything Theyll say that I was clever If we go down then we go down together Well get away with everything Les show them we are better Lets show them we are better Lets show them we are better'
		},
		"Brazil":
		{
			name: "BRA",
			refugees: "40",
			caption:"Someone Just Like This",
			details: 'Ive been reading books of old The legends and the myths Achilles and his gold Hercules and his gifts Spidermans control And Batman with his fists And clearly I dont see myself upon that list But she said, where dyou wanna go? How much you wanna risk? Im not looking for somebody With some superhuman gifts Some superhero Some fairytale bliss Just something I can turn to Somebody I can kiss'}
	};

	//clear bubbles and arcs on change of slider
	$('#bubbles g.bubbles').empty();
	$('#bubbles g.arc').empty();
	

	$('.description').empty();
	$('.description').append("<h1 class='caption'>"+data[value].caption+"</h1><p class='details'>"+data[value].details+"</p>");

    console.log(value);
    //draw green arc from selected slider val to Ithaca
    map.arc([
	{
		strokeColor: '#6AE368',
		origin: data[value].name,
		destination: {
			// this is Ithaca
			latitude: '42.4440',
			longitude: '-76.5019'
		}	
	}
	], 
	{strokeWidth: 1, arcSharpness: 1.4});

    //draw red circle on selected slider val
	map.bubbles([
	{
		name: value,
	    radius: 10,
	    centered: data[value].name,
	    refugees: data[value].refugees,
	    borderColor: '#FF0000',
	    // how to set fill color????
	}
	],
	//on hover, this is what will be displayed
	{
	  popupTemplate: function(geo, data) {
	  	// console.log(data);
	  	// console.log(data.name);
	  	// console.log(data.refugees);
	  	return '<h1>Country Name: '+data.name+'</h1><h3>Number of Refugees: '+ data.refugees+'</h3>';
	  }
	});

}));

</script>
</body>
</html>
