<html>
<head>
	<script src="https://d3js.org/d3.v3.min.js"></script>
 	<!-- using v3 rather than v4 because datamaps wont operate without it -->
	<script src="http://d3js.org/topojson.v2.min.js"></script>
	<script src="node_modules/datamaps/dist/datamaps.world.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
	<script src="d3.slider.js"></script>
	<link rel="stylesheet" href="style.css" type="text/css">
	<link rel="stylesheet" href="d3.slider.css" type="text/css">
	<link rel="stylesheet" href="foundation.min.css" type="text/css">
</head>
<body>
	<h1 class="header"> Ithaca Through Refugees </h1>
	<div class="row">
		<div id="bubbles" class="small-12 large-6 columns">
			<div id= "ordinalScale"></div>
		</div>
		<div class="description small-12 large-6 columns">
			<h1> 1990 Bosnia conflict </h1>
			<p>Taking it slow, but it's not typicalHe already knows that my love is fire His heart was a stone, but then his hands roamed I turned him to gold and it took him higher Well, I'll be your daydream, I'll be your favorite things We could be beautiful Get drunk on the good life, I'll take you to paradise Say you'll never let me go Deep in my bones, I can feel you Take me back to a time only we knew Hideaway We could waste the night with an old film Smoke a little weed on the couch in the back room Hideaway Say you'll never let me go Say you'll never let me go Ah, ah, ah Ah, ah, ah Ah, ah, ah Say you'll never let me go Say you'll never let me go Say you'll never let me go Say you'll never let me go Deep in my bones, I can feel you Take me back to a time only we knew Hideaway We could waste the night with an old film Smoke a little weed on the couch in the back room Hideaway Say you'll never let me go Say you'll never let me go
			<br> <br>sfljdshjl </p> 
		</div>
	</div>
	
	

 	<script>
var map = new Datamap({
  element: document.getElementById("bubbles"),
  done: function(datamap) {
            datamap.svg.selectAll('.datamaps-subunit').on('click', function(geography) {
            
            	// clears arcs, bubbles on each click of a country, could be useful
            	$('#bubbles g.arc').empty();
            	$('#bubbles g.bubbles').empty();

            	//enables click a country, draw arc from that point to Ithaca
        		console.log("Entering arc drawing");
        		map.arc([
        		{
        			strokeColor: '#6AE368',
        			origin: geography.id,
        			destination: {
        				// this is Ithaca
        				latitude: '42.4440',
        				longitude: '-76.5019'
        			}	
        		}
    			], {strokeWidth: 1, arcSharpness: 1.4});
      
            	console.log(geography);
            });
        },

  geographyConfig: {
    popupOnHover: false,
    highlightOnHover: true,
    highlightFillColor: '#6AE368'
  },
  fills: {
    defaultFill: '#000000'
  }
});

//generates slider
// little bit of latency due to json load, how to fix????
events = d3.slider().scale(d3.scale.ordinal().domain(["NULL", "Syria", "Australia", "India", "Brazil"]).rangePoints([0, 1], 0.5)).axis(d3.svg.axis()).snap(true).value("NULL");

//handles slider movement
d3.select('#ordinalScale').call(events.on("slide", function (evt, value){
	//fill this in with actual data
	data={"Syria":
		{
			name: 'SYR',
			refugees: '10'
		},
		"Australia":
		{
			name: "AUS",
			refugees: "20"
		},
		"India":
		{
			name: "IND",
			refugees: "30"
		},
		"Brazil":
		{
			name: "BRA",
			refugees: "40"
		}
	};

	//clear bubbles and arcs on change of slider
	$('#bubbles g.bubbles').empty();
	$('#bubbles g.arc').empty();

    console.log(value);
    //draw green arc from selected slider val to Ithaca
    map.arc([
	{
		strokeColor: '#6AE368',
		origin: data[value].name,
		destination: {
			// this is Ithaca
			latitude: '42.4440',
			longitude: '-76.5019'
		}	
	}
	], {strokeWidth: 1, arcSharpness: 1.4});
    //draw red circle on selected slider val
	map.bubbles([
	{
		name: value,
	    radius: 10,
	    centered: data[value].name,
	    refugees: data[value].refugees,
	    borderColor: '#FF0000',
	    // how to set fill color????
	}],
	//on hover, this is what will be displayed
	{
	  popupTemplate: function(geo, data) {
	  	// console.log(data);
	  	// console.log(data.name);
	  	// console.log(data.refugees);
	  	return '<h1>'+data.name+'</h1>';
	  }
	}
	);
}));

</script>
</body>
</html>
